模拟退火算法来源于固体退火原理，是一种基于概率的算法，将固体加温至充分高，再让其徐徐冷却，加温时，固体内部粒子随温升变为无序状，内能增大，而徐徐冷却时粒子渐趋有序，在每个温度都达到平衡态，最后在常温时达到基态，内能减为最小。
模拟退火算法从某一较高初温出发，伴随温度参数的不断下降,结合概率突跳特性在解空间中随机寻找目标函数的全局最优解，即在局部最优解能概率性地跳出并最终趋于全局最优。模拟退火算法是通过赋予搜索过程一种时变且最终趋于零的概率突跳性，从而可有效避免陷入局部极小并最终趋于全局最优的串行结构的优化算法。
# 蒙特卡洛模拟
随机生成很多组解，验证这些解是否满足题目的约束条件，若满足则将其保存到一个 “可行集”中，然后计算这个可行集内每个解对应的目标函数值，在里面找到最值即可。
**对比穷举法**：穷举法是按照某一特定的规则来穷举整个空间，蒙特卡罗模拟是随机搜 索，这是两者的区别。共同的缺点：难以解决解很多的情况。
比如：求解函数$y=11sinx+7cos(5x)$ 在某一区间内的最大值。
蒙特卡洛模拟：随机生成一万个数；
对比穷举法：$x$ 每次增长一个固定的长度。
$$
\begin{cases}
盲目式搜索：搜索过程中获取的中间信息不用来改进策略\\
启发式搜索：利用了中间搜索的信息改进策略
\end{cases}
$$
# 原理
更新解的机制为，如果新解比当前解更优，则接受新解，否则基于`Metropolis`准则判断是否接受新解。
`Metropolis` 算法，如何在局部最优解的情况下让其跳出来。
接收概率为：
$$
P=
\begin{cases}
1,E_{t+1}<E_t\\
e^{\frac{-(E_{t+1}-E_t)}{kT}},E_{t+1}\ge E_t
\end{cases}
$$
如上，当前搜索的解为$x_t$ ，对应的系统能量（目标函数）为$E_t$，施动搜索点，产生新解$x_{t+1}$ ，系统能量为$E_{t+1}$ ，那么系统对搜索点从$x_t$ 到$x_{t+1}$转变的接受概率就为上公式。
# 流程
$$
两个循环
\begin{cases}
内循环-Metroplis算法\\
外循环-退火过程
\end{cases}
$$
1. 令$T=T_0$ ，表示开始退火的初始温度，随机产生一个初始解 $x_0$ ，并计算对应的目标函数值 $E(0)$ ；
2. 令$T=kT$ ，其中`k`取值`0`到`1`之间，为温度下降速率；
3. 当前解 $x_t$ 施加随机扰动，在其邻域内产生一个新解 $x_{t+1}$ ，并计算对应的目标函数值$E(x_{t+1})$ ；
4. 如果能量变化量小于零，接收新解作为当前解，否则按照$e^{\frac{-(E_{t+1}-E_t)}{kT}}$ 判断（计算出概率，随机生成一个数 $r$ ，如果 $r<p$ ，则保留新解）是否接受新解；
5. 温度 $T$ 下，重复扰动和接收过程，即重复步骤`3`和`4`；
6. 判断温度是否达到终止条件，若是则终止算法，否则返回步骤`2`。
![[模拟退火算法步骤.png]]

## 说明

1. 在算法运行初期，温度下降快，避免接受过多的差结果。当运行时间增加，温度下降减缓，以便于更快稳定结果；
2. 当迭代次数增加到一定次数时，结果可能已经达到稳定，但是距离算法结束还有一段时间。在设计程序时应该加入适当的输出条件，满足输出条件即可结束程序。
### 收敛的一般性条件
1. 初始温度足够高；
2. 热平衡时间足够长；
3. 终止温度足够低；
4. 降温过程足够慢。
### 参数的选择
#### 初始温度
求解全局优化问题的随机搜索算法一般都采用大范围的粗略搜索与局部的精细搜索相结合的搜索策略。只有在初始的大范围搜索阶段找到全局最优解所在的区域，才能逐渐缩小搜索的范围，最终求出全局最优解。模拟退火算法是通过控制退火温度的初值 $T_0$ 和其衰减变化过程来实现大范围的粗略搜索与局部的精细搜索。一般来说，只有足够大 的 $T_0$ 才能满足算法要求(但对不同的问题“足够大”的含义也不同，有的可能 $T_0=100$ 就可以，有的则要1000。在问题规模较大时，过小的 $T_0$ 往往导致算法难以跳出局部陷阱而达不到全局最优。但为了减少计算量，$T_0$ 不宜取得过大，而应与其他参数折中选取。
#### 衰减系数

#### $Markov$ 链长度
在衰减函数已经选择的情况下，使得每一个控制参数 $T$ 都能在取值上达到平衡。
# 实例分析
